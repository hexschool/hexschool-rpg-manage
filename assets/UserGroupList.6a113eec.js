import{r as l,s as B,z as _,a as w,e as L,f,A as a,b as e,D as G,M as R,y as C,N as z,o as F,B as E,c as x,F as N,q as P,i as j,x as M,O as q,E as D,h as g,g as O,P as S}from"./index.b171e68b.js";const A={class:"mb-3"},K=e("label",{for:"name",class:"form-label"},"\u540D\u7A31",-1),T={class:"mb-3"},H=e("label",{for:"abbr",class:"form-label"},"\u82F1\u6587\u540D\u7A31",-1),I=["disabled"],J={__name:"CreateUserGroupModal",props:{tempUserGroup:{type:Object,default(){return{}}}},emits:["createUserGroupMethod"],setup(V,{expose:U,emit:u}){const v=V,{apiPostUserGroups:y}=C,d=l(),o=l({}),c=l(null);B(()=>v.tempUserGroup.name,()=>{o.value=v.tempUserGroup});const k=async()=>{try{const i={name:o.value.name,keyword:o.value.keyword,enable:!0};await y(i),u("createUserGroupMethod",{target:"import",type:"\u6210\u529F"}),d.value.resetForm()}catch(i){u("createUserGroupMethod",{target:"import",type:"\u5931\u6557",error:`${i.response.data.statusCode}:${i.response.data.message}`})}};return U({createUserGroupModalRef:c}),(i,p)=>{const b=_("Field"),r=_("ErrorMessage"),t=_("VForm");return w(),L(t,{ref_key:"refs",ref:d,onSubmit:k},{default:f(({errors:m,meta:h})=>[a(R,{ref_key:"createUserGroupModalRef",ref:c,"has-footer":!0,title:"\u65B0\u589E\u4F7F\u7528\u8005\u7FA4\u7D44","class-list":""},{body:f(()=>[e("div",A,[K,a(b,{id:"name",modelValue:o.value.name,"onUpdate:modelValue":p[0]||(p[0]=n=>o.value.name=n),name:"name",label:"\u540D\u7A31",type:"text",class:G(["form-control",{"is-invalid":m.name}]),rules:"required"},null,8,["modelValue","class"]),a(r,{name:"name",class:"invalid-feedback"})]),e("div",T,[H,a(b,{id:"abbr",modelValue:o.value.keyword,"onUpdate:modelValue":p[1]||(p[1]=n=>o.value.keyword=n),name:"keyword",label:"\u82F1\u6587\u540D\u7A31",type:"text",class:G(["form-control",{"is-invalid":m.keyword}]),rules:{required:!0,regex:/^[a-z_-]{1,50}$/}},null,8,["modelValue","class"]),a(r,{name:"keyword",class:"invalid-feedback"})])]),footer:f(()=>[e("button",{type:"submit",disabled:!h.valid,class:"btn btn-primary"}," \u5EFA\u7ACB ",8,I)]),_:2},1536)]),_:1},512)}}},Q={class:"about px-4 mt-4 position-relative"},W=e("h1",{class:"fs-4 mb-0"},"\u4F7F\u7528\u8005\u7FA4\u7D44",-1),X={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},Y={class:"card-header bg-white"},Z={class:"d-flex justify-content-between align-items-center"},ee=e("h2",{class:"h6 mb-0"},"\u4F7F\u7528\u8005\u7FA4\u7D44",-1),se={class:"input-group align-items-center"},te=e("div",{class:"bg-white border-0"},[e("span",{class:"material-icons fs-6 align-middle"}," search ")],-1),oe={class:"card-body p-0"},ae={class:"table-responsive"},re={class:"table table-hover mb-0 text-nowrap",style:{"font-size":"14px"}},le=e("thead",{class:"bg-light"},[e("tr",null,[e("th",{scope:"col",class:"ps-4 py-3 text-muted border-0"}," \u540D\u7A31 "),e("th",{scope:"col",class:"py-3 text-muted border-0"},"\u82F1\u6587\u540D\u7A31"),e("th",{scope:"col",class:"py-3 text-muted border-0"},"\u4F86\u6E90"),e("th",{scope:"col",class:"py-3 text-muted pe-3 border-0"}," \u5EFA\u7ACB\u6642\u9593 "),e("th",{scope:"col",class:"py-3 text-muted border-0"},"\u7DE8\u8F2F")])],-1),ne={class:"text-nowrap"},de={scope:"row",class:"ps-4"},ce={class:"fs-6 mb-0"},ie=e("span",{class:"material-icons align-middle fs-6"}," edit ",-1),ue={class:"card-footer bg-white py-3"},pe={class:"d-flex flex-wrap align-items-start"},_e={__name:"UserGroupList",setup(V){const{apiGetUserGroups:U}=C,u=l(""),v=z.useLoading(),y=l([]),d=l({total:0,current_page:1}),o=l(""),c=async({keyword:r,page:t,count:m}={})=>{const h=v.show();try{const{groups:n,pagination:s}=await U({keyword:r,page:t,count:m});y.value=n,d.value=s}catch{M("danger","\u53D6\u5F97\u4F7F\u7528\u8005\u7FA4\u7D44\u5217\u8868\u5931\u6557","\u53D6\u5F97\u4F7F\u7528\u8005\u7FA4\u7D44\u5217\u8868\u5931\u6557")}finally{h.hide()}};F(()=>{c()});const k=l({}),i=()=>{u.value.show()},p=r=>{r.type==="\u6210\u529F"?M("success","\u5EFA\u7ACB\u4F7F\u7528\u8005\u7FA4\u7D44\u6210\u529F","\u5DF2\u6210\u529F\u5EFA\u7ACB\u4F7F\u7528\u8005\u7FA4\u7D44"):r.type==="\u5931\u6557"&&M("danger","\u5EFA\u7ACB\u4F7F\u7528\u8005\u7FA4\u7D44\u5931\u6557",r.error),u.value.hide(),c()},b=l(null);return F(()=>{u.value=new E(b.value.createUserGroupModalRef.hModal)}),(r,t)=>{const m=_("Field"),h=_("VForm"),n=_("router-link");return w(),x("div",null,[e("div",Q,[e("header",{class:"d-flex align-items-center justify-content-between border-bottom border-light pb-2 mb-4"},[W,e("button",{type:"button",class:"btn btn-primary",onClick:i},"\u65B0\u589E\u4F7F\u7528\u8005\u7FA4\u7D44")]),e("div",X,[e("div",Y,[e("div",Z,[ee,a(h,null,{default:f(({errors:s})=>[e("div",se,[te,a(m,{id:"dataTableSearch",name:"search",label:"\u641C\u5C0B",modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=$=>o.value=$),type:"search",class:G(["form-control border-top-0 border-start-0 border-end-0 rounded-0",{"is-invalid":s.search}]),placeholder:"\u641C\u5C0B\u540D\u7A31\u3001\u82F1\u6587\u540D\u7A31",onKeydown:t[1]||(t[1]=q(D($=>c({keyword:o.value}),["prevent"]),["enter"]))},null,8,["modelValue","class"])])]),_:1})])]),e("div",oe,[e("div",ae,[e("table",re,[le,e("tbody",ne,[(w(!0),x(N,null,P(y.value,s=>(w(),x("tr",{key:s.id,class:"align-middle"},[e("td",de,[e("h5",ce,g(s.name),1)]),e("td",null,g(s.keyword),1),e("td",null,g(s.from),1),e("td",null,g(s.created_at.substr(0,9)),1),e("td",null,[a(n,{to:`/admin/users/groups/${s.id}`,class:"btn btn-sm btn-outline-gray"},{default:f(()=>[ie,O(" \u7DE8\u8F2F ")]),_:2},1032,["to"])])]))),128))])])])]),e("div",ue,[e("div",pe,[a(j(S),{modelValue:d.value.current_page,"onUpdate:modelValue":t[2]||(t[2]=s=>d.value.current_page=s),records:d.value.total,"per-page":20,options:{chunk:6},onPaginate:t[3]||(t[3]=s=>c({page:s}))},null,8,["modelValue","records"])])])])]),a(J,{ref_key:"createUserGroupModalComponentRef",ref:b,"temp-user-group":k.value,onCreateUserGroupMethod:p},null,8,["temp-user-group"])])}}};export{_e as default};
